/*********************************************************************
*
*   MODULE:
*       assert.h
*
*   DESCRIPTION:
*       Diagnostics
*
*********************************************************************/

#ifndef _ASSERT_H
#define _ASSERT_H

/*--------------------------------------------------------------------
                               INCLUDES
--------------------------------------------------------------------*/

#include <stdlib.h>

/*--------------------------------------------------------------------
                          LITERAL CONSTANTS
--------------------------------------------------------------------*/

/*--------------------------------------------------------------------
                                TYPES
--------------------------------------------------------------------*/

/*--------------------------------------------------------------------
                           MEMORY CONSTANTS
--------------------------------------------------------------------*/

#ifdef __cplusplus
extern "C" {
#endif

/*--------------------------------------------------------------------
                                VARIABLES
--------------------------------------------------------------------*/

/*--------------------------------------------------------------------
                                MACROS
--------------------------------------------------------------------*/

#define static_assert _Static_assert

#ifdef NDEBUG
#define assert(condition) ((void)0)

#else

//TODO: This should print to stderror once it's implemented
#define assert( condition )                         \
    do  {                                           \
        if( !(condition) )                          \
            {                                       \
            printf( "%s:%d: %s: Assertion '" #condition "' failed.\n", __FILE__, __LINE__, __func__ );   \
            abort();                                \
            }                                       \  
        }                                           \
    while(0)

#endif /* NDEBUG */

/*--------------------------------------------------------------------
                              PROCEDURES
--------------------------------------------------------------------*/

#ifdef __cplusplus
}
#endif
#endif /* _ASSERT_H */